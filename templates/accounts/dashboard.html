{% extends "base.html" %}
{% load static %}
{% block content %}

<style>
    @keyframes rise {
        from {
            opacity: 0;
            transform: translateY(12px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-rise {
        animation: rise .5s ease-out both;
    }
</style>

<div class="max-w-7xl mx-auto px-6 py-10">

    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-10">
        <div>
            <h1 class="text-4xl font-extrabold text-gray-900 tracking-tight">
                Dashboard
            </h1>
            <p class="text-gray-500 mt-1">
                Overview of your activity and performance
            </p>
        </div>

        <a href="{% url 'accounts:profile' %}"
            class="inline-flex items-center gap-2 px-5 py-3 rounded-xl bg-indigo-600 text-white font-semibold shadow hover:bg-indigo-700 transition">
            ‚úèÔ∏è Edit Profile
        </a>
    </div>

    <!-- KPI CARDS -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">

        {% comment %} CARD {% endcomment %}
        <div
            class="animate-rise group bg-white rounded-2xl border border-gray-200 shadow-sm hover:shadow-xl transition p-6 cursor-pointer">
            <div class="flex items-center gap-4">
                <div class="p-4 rounded-xl bg-blue-100 text-blue-600 text-2xl">
                    üè†
                </div>
                <div>
                    <p class="text-sm text-gray-500">Total Listings</p>
                    <p class="text-3xl font-extrabold">{{ listings.count }}</p>
                </div>
            </div>
        </div>

        <div
            class="animate-rise group bg-white rounded-2xl border border-gray-200 shadow-sm hover:shadow-xl transition p-6 cursor-pointer">
            <div class="flex items-center gap-4">
                <div class="p-4 rounded-xl bg-green-100 text-green-600 text-2xl">
                    üí¨
                </div>
                <div>
                    <p class="text-sm text-gray-500">Active Chats</p>
                    <p class="text-3xl font-extrabold">{{ inquiries.count }}</p>
                </div>
            </div>
        </div>

        <div
            class="animate-rise group bg-white rounded-2xl border border-gray-200 shadow-sm hover:shadow-xl transition p-6 cursor-pointer">
            <div class="flex items-center gap-4">
                <div class="p-4 rounded-xl bg-purple-100 text-purple-600 text-2xl">
                    üìÑ
                </div>
                <div>
                    <p class="text-sm text-gray-500">Agreements</p>
                    <p class="text-3xl font-extrabold">{{ agreements.count }}</p>
                </div>
            </div>
        </div>

    </div>

    <!-- MAIN GRID -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

        <!-- MY LISTINGS -->
        <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-6">
            <div class="flex justify-between items-center mb-5">
                <h3 class="text-xl font-bold">My Listings</h3>
                <a href="{% url 'listings:add_listing' %}" class="text-indigo-600 font-medium hover:underline">
                    + Add Listing
                </a>
            </div>

            <div class="divide-y">
                {% for l in listings %}
                <a href="/listings/{{ l.id }}/" class="block py-4 hover:bg-gray-50 transition rounded-lg px-2">
                    <p class="font-semibold text-gray-900">{{ l.title }}</p>
                    <p class="text-sm text-gray-500">‚Çπ{{ l.rent }}</p>
                </a>
                {% empty %}
                <p class="text-sm text-gray-500 py-6 text-center">
                    No listings yet
                </p>
                {% endfor %}
            </div>
        </div>

        <!-- RECENT CHATS -->
        <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-6">
            <h3 class="text-xl font-bold mb-5">Recent Chats</h3>

            <div class="space-y-4">
                {% for i in inquiries|slice:":3" %}
                <a href="{% url 'chat:chat_room' i.id %}"
                    class="block p-4 rounded-xl border hover:shadow-md transition group">
                    <p class="font-semibold group-hover:text-indigo-600">
                        {{ i.listing.title }}
                    </p>
                    <p class="text-sm text-gray-500">
                        With
                        {% if i.from_user == user %}
                        {{ i.to_user.full_name }}
                        {% else %}
                        {{ i.from_user.full_name }}
                        {% endif %}
                    </p>
                </a>
                {% empty %}
                <p class="text-sm text-gray-500 text-center py-6">
                    No chats yet
                </p>
                {% endfor %}
            </div>

            <a href="/chat/inbox/" class="block mt-6 text-center text-indigo-600 font-medium hover:underline">
                View All Chats ‚Üí
            </a>
        </div>

        <!-- AGREEMENTS -->
        <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-6">
            <h3 class="text-xl font-bold mb-5">Agreements</h3>

            <div class="space-y-4">
                {% for a in agreements %}
                <a href="/agreements/view/{{ a.id }}/"
                    class="flex justify-between items-center p-4 rounded-xl border hover:bg-gray-50 transition">
                    <p class="font-semibold">{{ a.listing.title }}</p>
                    <span class="text-indigo-600 font-medium">View ‚Üí</span>
                </a>
                {% empty %}
                <p class="text-sm text-gray-500 text-center py-6">
                    No agreements yet
                </p>
                {% endfor %}
            </div>
        </div>

    </div>

</div>

{% endblock %}